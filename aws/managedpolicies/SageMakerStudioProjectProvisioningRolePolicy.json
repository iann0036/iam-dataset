{
  "access_levels": [
    "List",
    "Read",
    "Tagging",
    "Write",
    "Permissions management"
  ],
  "arn": "arn:aws:iam::aws:policy/service-role/SageMakerStudioProjectProvisioningRolePolicy",
  "createdate": "2025-06-03T22:52:07Z",
  "credentials_exposure": true,
  "data_access": true,
  "deprecated": false,
  "document": {
    "Statement": [
      {
        "Action": [
          "cloudformation:CreateStack",
          "cloudformation:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:cloudformation:*:*:stack/DataZone*"
        ],
        "Sid": "CfnCreate"
      },
      {
        "Action": [
          "cloudformation:DescribeStacks",
          "cloudformation:DescribeStackEvents",
          "cloudformation:UpdateStack"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:cloudformation:*:*:stack/DataZone*"
        ],
        "Sid": "CfnManage"
      },
      {
        "Action": [
          "cloudformation:DeleteStack",
          "cloudformation:DescribeStacks"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:cloudformation:*:*:stack/DataZone*"
        ],
        "Sid": "CfnDelete"
      },
      {
        "Action": [
          "lakeformation:GetDataLakeSettings",
          "lakeformation:PutDataLakeSettings",
          "lakeformation:RevokePermissions",
          "lakeformation:BatchRevokePermissions",
          "lakeformation:ListPermissions",
          "lakeformation:RegisterResource",
          "lakeformation:DeregisterResource",
          "lakeformation:GrantPermissions",
          "lakeformation:BatchGrantPermissions",
          "lakeformation:ListResources",
          "lakeformation:DescribeResource"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "LFManage"
      },
      {
        "Action": [
          "s3:GetObject"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          },
          "StringNotEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "GetDataZoneTemplate"
      },
      {
        "Action": [
          "codecommit:CreateRepository",
          "codecommit:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:codecommit:*:*:datazone*",
        "Sid": "CodeCommitCreate"
      },
      {
        "Action": [
          "codecommit:DeleteRepository",
          "codecommit:UpdateRepositoryEncryptionKey",
          "codecommit:PutRepositoryTriggers"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:codecommit:*:*:datazone*",
        "Sid": "CodeCommitDeletion"
      },
      {
        "Action": [
          "codecommit:GetBranch",
          "codecommit:CreateCommit",
          "codecommit:GetRepository",
          "codecommit:GetFile"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:codecommit:*:*:datazone*",
        "Sid": "CodeCommitAccess"
      },
      {
        "Action": [
          "codecommit:ListRepositories"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "CodeCommitList"
      },
      {
        "Action": [
          "kms:Decrypt",
          "kms:ReEncryptTo",
          "kms:ReEncryptFrom",
          "kms:GenerateDataKey"
        ],
        "Condition": {
          "Null": {
            "kms:EncryptionContext:aws:codecommit:id": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          },
          "StringLike": {
            "kms:ViaService": [
              "codecommit.*.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "CodeCommitKms"
      },
      {
        "Action": [
          "iam:GetRole"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*",
          "arn:aws:iam::*:role/AmazonBedrock*",
          "arn:aws:iam::*:role/BedrockStudio*"
        ],
        "Sid": "GetIAMRole"
      },
      {
        "Action": [
          "iam:CreateRole",
          "iam:DetachRolePolicy",
          "iam:DeleteRolePolicy",
          "iam:AttachRolePolicy",
          "iam:PutRolePolicy"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*",
          "arn:aws:iam::*:role/AmazonBedrockExecution*",
          "arn:aws:iam::*:role/BedrockStudio*",
          "arn:aws:iam::*:role/AmazonBedrockConsumptionRole*",
          "arn:aws:iam::*:role/AmazonBedrockEvaluation*"
        ],
        "Sid": "IAMManage"
      },
      {
        "Action": [
          "iam:DeleteRolePolicy",
          "iam:PutRolePolicy"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*"
        ],
        "Sid": "IAMManageFromDataZone"
      },
      {
        "Action": [
          "iam:CreateRole"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*",
          "arn:aws:iam::*:role/AmazonBedrock*"
        ],
        "Sid": "IAMRoleCreation"
      },
      {
        "Action": [
          "iam:DetachRolePolicy",
          "iam:AttachRolePolicy"
        ],
        "Condition": {
          "ArnEquals": {
            "iam:PolicyARN": [
              "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePolicy",
              "arn:aws:iam::aws:policy/SageMakerStudioProjectRoleMachineLearningPolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioEMRServiceRolePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioEMRInstanceRolePolicy",
              "arn:aws:iam::aws:policy/service-role/AmazonEMRServicePolicy_v2",
              "arn:aws:iam::aws:policy/AmazonSageMakerPartnerAppsFullAccess",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseServiceRolePolicy"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*"
        ],
        "Sid": "IAMRoleManagement"
      },
      {
        "Action": [
          "iam:AttachRolePolicy",
          "iam:DetachRolePolicy"
        ],
        "Condition": {
          "ArnEquals": {
            "iam:PolicyARN": [
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockAgentServiceRolePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockChatAgentUserRolePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockFlowServiceRolePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockFunctionExecutionRolePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseServiceRolePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseCustomResourcePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockPromptUserRolePolicy",
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockEvaluationJobServiceRolePolicy"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/AmazonBedrock*",
        "Sid": "IAMRoleManagementForBedrock"
      },
      {
        "Action": [
          "iam:TagRole",
          "iam:UntagRole"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "AmazonBedrockManaged",
              "RedshiftDb*",
              "EnableAmazonBedrockPermissions",
              "EnableAmazonBedrockIDEPermissions",
              "EnableGlueWorkloadsPermissions",
              "EnableSageMakerMLWorkloadsPermissions",
              "DomainBucketName",
              "KmsKeyId",
              "LogGroupName",
              "RoleName",
              "vpcArn",
              "VpcId",
              "CreatedForUseWithSageMakerStudio",
              "SageMakerStudioQueryExecutionRole"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_usr_role_*",
          "arn:aws:iam::*:role/datazone-partner-apps-*",
          "arn:aws:iam::*:role/datazone_redshift_serverless_admin_role_*",
          "arn:aws:iam::*:role/AmazonBedrock*",
          "arn:aws:iam::*:role/BedrockStudio*",
          "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole"
        ],
        "Sid": "IAMRoleTagging"
      },
      {
        "Action": [
          "iam:TagRole",
          "iam:UntagRole"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "AmazonBedrockManaged",
              "DomainBucketName",
              "KmsKeyId",
              "AgentId",
              "AgentAliasId",
              "AppDefinitionPath",
              "DataSourcePath",
              "PromptId",
              "PromptVersion",
              "PromptDefinitionPath",
              "OpenSearchServerlessCollectionId"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/AmazonBedrock*",
        "Sid": "IAMRoleTaggingForBedrock"
      },
      {
        "Action": [
          "iam:TagRole"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "RedshiftDb*"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_usr_role_*"
        ],
        "Sid": "IAMRoleTaggingForRedshift"
      },
      {
        "Action": [
          "iam:TagRole",
          "iam:UntagRole"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "DataZone*",
              "for-use-with-amazon-emr-managed-policies",
              "DomainBucketName",
              "KmsKeyId",
              "VpcId"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_emr_service_role_*",
          "arn:aws:iam::*:role/datazone_emr_ec2_instance_role_*"
        ],
        "Sid": "IAMRoleTaggingForEmr"
      },
      {
        "Action": [
          "iam:UntagRole"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": "EnableAmazonBedrockIDEPermissions"
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/datazone_usr_role_*",
        "Sid": "IAMRoleUntagging"
      },
      {
        "Action": [
          "iam:DeleteRole",
          "iam:ListRolePolicies",
          "iam:GetRolePolicy",
          "iam:ListAttachedRolePolicies"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*",
          "arn:aws:iam::*:role/AmazonBedrock*",
          "arn:aws:iam::*:role/BedrockStudio*"
        ],
        "Sid": "IamManageRoles"
      },
      {
        "Action": [
          "iam:GetRole",
          "iam:UpdateAssumeRolePolicy"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_usr_role_*",
          "arn:aws:iam::*:role/datazone_emr_*",
          "arn:aws:iam::*:role/datazone-partner-apps-*",
          "arn:aws:iam::*:role/AmazonBedrock*"
        ],
        "Sid": "IamManageRolesFromDataZone"
      },
      {
        "Action": [
          "iam:AttachRolePolicy"
        ],
        "Condition": {
          "StringEquals": {
            "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*"
        ],
        "Sid": "IamAttachPolicyFromService"
      },
      {
        "Action": [
          "iam:DetachRolePolicy"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone*",
          "arn:aws:iam::*:role/AmazonBedrock*"
        ],
        "Sid": "IamDetachPolicyFromService"
      },
      {
        "Action": [
          "iam:DeletePolicy",
          "iam:CreatePolicy",
          "iam:ListPolicies",
          "iam:GetPolicy",
          "iam:GetPolicyVersion",
          "iam:CreatePolicyVersion",
          "iam:ListPolicyVersions",
          "iam:DeletePolicyVersion"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:policy/datazone*",
          "arn:aws:iam::*:policy/connector-manage-access-policy*",
          "arn:aws:iam::*:policy/SageMakerStudioQueryExecutionRolePolicy"
        ],
        "Sid": "IAMPolicyManagementFromService"
      },
      {
        "Action": [
          "iam:ListPolicies"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "IAMListPolicy"
      },
      {
        "Action": [
          "glue:ListConnectionTypes",
          "glue:DescribeConnectionType"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "GlueConnection"
      },
      {
        "Action": [
          "iam:GetInstanceProfile",
          "iam:CreateInstanceProfile",
          "iam:AddRoleToInstanceProfile",
          "iam:RemoveRoleFromInstanceProfile",
          "iam:DeleteInstanceProfile"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:instance-profile/datazone_emr_ec2_instance_profile_*",
        "Sid": "IAMInstanceProfile"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": [
              "cloudformation.amazonaws.com",
              "glue.amazonaws.com"
            ],
            "iam:PassedToService": [
              "glue.amazonaws.com",
              "lakeformation.amazonaws.com",
              "redshift-serverless.amazonaws.com",
              "redshift.amazonaws.com",
              "emr-serverless.amazonaws.com",
              "airflow.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_usr_role_*",
          "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole"
        ],
        "Sid": "IamPassRole"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "iam:PassedToService": [
              "sagemaker.amazonaws.com",
              "redshift-serverless.amazonaws.com",
              "bedrock.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_usr_role_*"
        ],
        "Sid": "IamPassRoleFromDataZone"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "iam:PassedToService": [
              "glue.amazonaws.com",
              "lakeformation.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_usr_role_*",
          "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole",
          "arn:aws:iam::*:role/service-role/AmazonSageMakerQueryExecution"
        ],
        "Sid": "IamPassRoleForGlueCatalog"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "iam:PassedToService": [
              "elasticmapreduce.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_emr_service_role_*"
        ],
        "Sid": "IamPassRoleForEmrServiceRole"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "iam:PassedToService": [
              "ec2.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_emr_ec2_instance_role_*"
        ],
        "Sid": "IamPassRoleForEmrInstanceRole"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "iam:PassedToService": "bedrock.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/AmazonBedrock*",
          "arn:aws:iam::*:role/BedrockStudio*"
        ],
        "Sid": "IamPassRoleToBedrock"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "iam:PassedToService": "lambda.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/AmazonBedrock*",
          "arn:aws:iam::*:role/BedrockStudio*"
        ],
        "Sid": "IamPassRoleToLambda"
      },
      {
        "Action": [
          "iam:CreateServiceLinkedRole"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "iam:AWSServiceName": "observability.aoss.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/aws-service-role/observability.aoss.amazonaws.com/AWSServiceRoleForAmazonOpenSearchServerless",
        "Sid": "IamCreateSLRForAoss"
      },
      {
        "Action": [
          "glue:CreateDatabase",
          "glue:GetDatabase"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:database/default",
          "arn:aws:glue:*:*:catalog"
        ],
        "Sid": "GlueDefaultDatabaseCreation"
      },
      {
        "Action": [
          "glue:CreateDatabase"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:database/*"
        ],
        "Sid": "GlueDbCreateFromCfn"
      },
      {
        "Action": [
          "glue:GetDatabase"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:database/*",
          "arn:aws:glue:*:*:catalog"
        ],
        "Sid": "GlueGetDatabaseForTagging"
      },
      {
        "Action": [
          "glue:DeleteDatabase"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "GlueDatabaseDeletion"
      },
      {
        "Action": [
          "glue:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "TagGlueResources"
      },
      {
        "Action": [
          "glue:GetConnection"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:catalog",
          "arn:aws:glue:*:*:connection/datazone-glue-network-connection-*"
        ],
        "Sid": "GetGlueConnectionToAllowTagging"
      },
      {
        "Action": [
          "glue:CreateConnection",
          "glue:DeleteConnection"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:connection/datazone-glue-network-connection-*",
          "arn:aws:glue:*:*:catalog"
        ],
        "Sid": "GlueConnectionCreateAndDelete"
      },
      {
        "Action": [
          "glue:PassConnection",
          "glue:GetConnections",
          "glue:GetTags"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:connection/*",
          "arn:aws:glue:*:*:catalog/*"
        ],
        "Sid": "FederatedGlueConnection"
      },
      {
        "Action": [
          "athena:CreateDataCatalog"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "FederatedAthenaConnection"
      },
      {
        "Action": [
          "glue:GetConnection"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:connection/*",
          "arn:aws:glue:*:*:catalog/*"
        ],
        "Sid": "FederatedGetConnection"
      },
      {
        "Action": [
          "athena:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "federated_athena*"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:athena:*:*:datacatalog/*",
        "Sid": "FederatedConnectionTag"
      },
      {
        "Action": [
          "glue:CreateConnection"
        ],
        "Condition": {
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:catalog",
          "arn:aws:glue:*:*:connection/*"
        ],
        "Sid": "FederatedConnectionCreate"
      },
      {
        "Action": [
          "glue:DeleteConnection",
          "glue:UpdateConnection"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:connection/*"
        ],
        "Sid": "FederatedConnectionManage"
      },
      {
        "Action": [
          "glue:DeleteConnection",
          "glue:UpdateConnection"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:catalog"
        ],
        "Sid": "FederatedConnectionManageCatalog"
      },
      {
        "Action": [
          "kms:Decrypt"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}",
            "kms:EncryptionContext:glue_catalog_id": "${aws:PrincipalAccount}"
          },
          "StringLike": {
            "kms:ViaService": [
              "glue.*.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "GlueKms"
      },
      {
        "Action": [
          "serverlessrepo:GetCloudFormationTemplate",
          "serverlessrepo:CreateCloudFormationTemplate"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:serverlessrepo:*:*:applications/Athena*"
        ],
        "Sid": "FederatedDBAthenaServerless"
      },
      {
        "Action": [
          "imagebuilder:GetComponent",
          "imagebuilder:GetContainerRecipe",
          "ecr:GetAuthorizationToken",
          "ecr:BatchGetImage",
          "ecr:BatchCheckLayerAvailability",
          "ecr:GetDownloadUrlForLayer"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaLast": "lambda.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ecr:*:*:repository/athena-federation-repository*"
        ],
        "Sid": "FederatedDBECR"
      },
      {
        "Action": [
          "cloudformation:CreateChangeSet",
          "cloudformation:DeleteChangeSet"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaLast": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:cloudformation:*:*:transform/Serverless*"
        ],
        "Sid": "FederatedDBAthenaCFN"
      },
      {
        "Action": [
          "lambda:CreateFunction",
          "lambda:DeleteFunction"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaLast": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:lambda:*:*:function:athenafederatedcatalog*"
        ],
        "Sid": "FederatedDBAthenaLambda"
      },
      {
        "Action": [
          "lambda:GetFunction"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaLast": [
              "athena.amazonaws.com",
              "cloudformation.amazonaws.com"
            ],
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:lambda:*:*:function:athenafederatedcatalog*"
        ],
        "Sid": "FederatedDBAthenaGetFunctionLambda"
      },
      {
        "Action": [
          "lambda:GetFunctionConfiguration",
          "lambda:UpdateFunctionConfiguration"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:lambda:*:*:function:athenafederatedcatalog*"
        ],
        "Sid": "FederatedDBAthenaUpdateLambda"
      },
      {
        "Action": [
          "lambda:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "aws:cloudformation:*",
              "federated_athena*",
              "lambda:createdBy"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaLast": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:lambda:*:*:function:athenafederatedcatalog*"
        ],
        "Sid": "FederatedDBAthenaLambdaTagging"
      },
      {
        "Action": [
          "s3:GetObject"
        ],
        "Condition": {
          "StringLike": {
            "aws:CalledViaLast": [
              "lambda.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:s3:::awsserverlessrepo*"
        ],
        "Sid": "FederatedDBAthenaS3"
      },
      {
        "Action": [
          "s3:ListBucket"
        ],
        "Condition": {
          "Null": {
            "s3:prefix": "true"
          },
          "StringEquals": {
            "aws:CalledViaLast": [
              "glue.amazonaws.com"
            ],
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:s3:::*"
        ],
        "Sid": "FederatedDBGlueS3"
      },
      {
        "Action": [
          "cloudformation:CreateStack",
          "cloudformation:DeleteStack",
          "cloudformation:DescribeStacks",
          "cloudformation:DescribeStackEvents"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/federated_athena_datacatalog": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:cloudformation:*:*:stack/athenafederatedcatalog*",
        "Sid": "FederatedDBAthenaCommon"
      },
      {
        "Action": [
          "athena:DeleteDataCatalog",
          "athena:GetDataCatalog",
          "athena:UpdateDataCatalog"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:athena:*:*:datacatalog/*",
        "Sid": "FederatedDBAthenaCatalog"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "iam:PassedToService": [
              "lambda.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/datazone_usr_role_*"
        ],
        "Sid": "FederatedDBPassRole"
      },
      {
        "Action": [
          "iam:GetRole"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole",
          "arn:aws:iam::*:role/service-role/AmazonSageMakerQueryExecution"
        ],
        "Sid": "FederatedDBGetRole"
      },
      {
        "Action": [
          "glue:CreateCatalog"
        ],
        "Condition": {
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:catalog",
          "arn:aws:glue:*:*:catalog/*"
        ],
        "Sid": "GlueCatalogCreation"
      },
      {
        "Action": [
          "glue:GetCatalog",
          "glue:GetCatalogs",
          "glue:UpdateCatalog",
          "glue:DeleteCatalog",
          "glue:GetDatabase"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:glue:*:*:catalog",
          "arn:aws:glue:*:*:catalog/*"
        ],
        "Sid": "GlueCatalogManagement"
      },
      {
        "Action": [
          "redshift-serverless:CreateNamespace",
          "redshift-serverless:CreateWorkgroup",
          "redshift-serverless:DeleteNamespace",
          "redshift-serverless:DeleteWorkgroup",
          "redshift-serverless:ListTagsForResource",
          "redshift-serverless:GetNamespace",
          "redshift-serverless:GetWorkgroup"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:redshift-serverless:*:*:namespace/*",
          "arn:aws:redshift-serverless:*:*:workgroup/*"
        ],
        "Sid": "RedshiftManage"
      },
      {
        "Action": [
          "redshift:AssociateDataShareConsumer",
          "redshift:AuthorizeDataShare"
        ],
        "Condition": {
          "ForAnyValue:StringLike": {
            "aws:CalledVia": [
              "redshift-serverless.amazonaws.com",
              "glue.amazonaws.com"
            ]
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:redshift:*:*:datashare:*/*"
        ],
        "Sid": "RedshiftDataShare"
      },
      {
        "Action": [
          "s3:CreateBucket",
          "s3:DeleteBucket",
          "s3:PutBucketPolicy",
          "s3:PutEncryptionConfiguration",
          "s3:PutLifecycleConfiguration",
          "s3:PutBucketVersioning",
          "s3:PutBucketTagging"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:s3:::redshift-staging-bucket-*",
        "Sid": "RedshiftBucket"
      },
      {
        "Action": [
          "redshift-serverless:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:redshift-serverless:*:*:namespace/*",
          "arn:aws:redshift-serverless:*:*:workgroup/*"
        ],
        "Sid": "RedshiftTag"
      },
      {
        "Action": [
          "ec2:CreateSecurityGroup"
        ],
        "Condition": {
          "Null": {
            "aws:TagKeys": "true"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*",
          "arn:aws:ec2:*:*:vpc/*"
        ],
        "Sid": "CreateSG"
      },
      {
        "Action": [
          "ec2:AuthorizeSecurityGroupEgress",
          "ec2:AuthorizeSecurityGroupIngress"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "SGAuth"
      },
      {
        "Action": [
          "ec2:DeleteSecurityGroup",
          "ec2:RevokeSecurityGroupEgress",
          "ec2:RevokeSecurityGroupIngress"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "SGManage"
      },
      {
        "Action": [
          "ec2:RevokeSecurityGroupIngress"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "SGRevoke"
      },
      {
        "Action": [
          "ec2:CreateTags"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "for-use-with-amazon-emr-managed-policies",
              "aws:cloudformation:*"
            ]
          },
          "Null": {
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "EC2ResourceTagging"
      },
      {
        "Action": [
          "ec2:DescribeVpcs",
          "ec2:DescribeSecurityGroups",
          "ec2:DescribeNatGateways",
          "ec2:DescribeRouteTables",
          "ec2:DescribeSubnets",
          "ec2:DescribeAccountAttributes",
          "ec2:DescribeAvailabilityZones"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "EC2Describe"
      },
      {
        "Action": [
          "logs:DescribeLogGroups"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "DescribeLogGroups"
      },
      {
        "Action": [
          "logs:CreateLogGroup",
          "logs:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "AmazonBedrockManaged"
            ]
          },
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:logs:*:*:log-group:datazone-*",
          "arn:aws:logs:*:*:log-group:/aws/lambda/amazon-bedrock-ide-*"
        ],
        "Sid": "LogGroupCreation"
      },
      {
        "Action": [
          "logs:PutRetentionPolicy"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:logs:*:*:log-group:datazone-*",
          "arn:aws:logs:*:*:log-group:/aws/lambda/amazon-bedrock-ide-*"
        ],
        "Sid": "LogGroupPutRetentionPolicy"
      },
      {
        "Action": [
          "logs:DeleteLogGroup",
          "logs:DeleteRetentionPolicy",
          "logs:GetDataProtectionPolicy",
          "logs:PutDataProtectionPolicy",
          "logs:DeleteDataProtectionPolicy",
          "logs:AssociateKmsKey",
          "logs:DisassociateKmsKey",
          "logs:ListTagsForResource"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:logs:*:*:log-group:datazone-*",
          "arn:aws:logs:*:*:log-group:/aws/lambda/amazon-bedrock-ide-*"
        ],
        "Sid": "ManageLogGroups"
      },
      {
        "Action": [
          "athena:CreateWorkGroup",
          "athena:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:athena:*:*:workgroup/*",
        "Sid": "AthenaManage"
      },
      {
        "Action": [
          "athena:DeleteWorkGroup",
          "athena:GetWorkGroup"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:athena:*:*:workgroup/*",
        "Sid": "AthenaWorkgroupDeletion"
      },
      {
        "Action": [
          "redshift-serverless:CreateNamespace",
          "redshift-serverless:CreateWorkgroup",
          "redshift-serverless:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:redshift-serverless:*:*:namespace/*",
          "arn:aws:redshift-serverless:*:*:workgroup/*"
        ],
        "Sid": "RedshiftCreate"
      },
      {
        "Action": [
          "redshift-serverless:ListTagsForResource"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:redshift-serverless:*:*:namespace/*",
          "arn:aws:redshift-serverless:*:*:workgroup/*"
        ],
        "Sid": "RedshiftServerlessListTags"
      },
      {
        "Action": [
          "secretsmanager:CreateSecret",
          "secretsmanager:DeleteSecret",
          "secretsmanager:UpdateSecret"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:ResourceTag/CreatedBy": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "AllowSecretManagement"
      },
      {
        "Action": [
          "secretsmanager:DescribeSecret"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "DescribeSecret"
      },
      {
        "Action": [
          "secretsmanager:DescribeSecret"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceTag/for-use-with-all-datazone-projects": "true"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "DescribeAllSecrets"
      },
      {
        "Action": [
          "secretsmanager:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*",
              "CreatedBy"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:ResourceTag/CreatedBy": "false",
            "aws:TagKeys": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "AllowSecretTagging"
      },
      {
        "Action": [
          "kms:GenerateDataKey",
          "kms:Decrypt"
        ],
        "Condition": {
          "Null": {
            "kms:EncryptionContext:SecretARN": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          },
          "StringLike": {
            "kms:ViaService": [
              "secretsmanager.*.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "SecretsManagerKmsPermissions"
      },
      {
        "Action": [
          "iam:CreateServiceLinkedRole"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/aws-service-role/redshift.amazonaws.com/AWSServiceRoleForRedshift",
          "arn:aws:iam::*:role/aws-service-role/sagemaker.amazonaws.com/AWSServiceRoleForAmazonSageMakerNotebooks",
          "arn:aws:iam::*:role/aws-service-role/ops.emr-serverless.amazonaws.com/AWSServiceRoleForAmazonEMRServerless",
          "arn:aws:iam::*:role/aws-service-role/airflow.amazonaws.com/AWSServiceRoleForAmazonMWAA",
          "arn:aws:iam::*:role/aws-service-role/elasticmapreduce.amazonaws.com/AWSServiceRoleForEMRCleanup"
        ],
        "Sid": "CreateSLR"
      },
      {
        "Action": [
          "redshift-serverless:ListNamespaces",
          "redshift-serverless:ListWorkgroups",
          "redshift:GetResourcePolicy"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "RedshiftList"
      },
      {
        "Action": [
          "redshift-data:ExecuteStatement",
          "redshift:GetResourcePolicy",
          "redshift-serverless:GetCredentials"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:redshift-serverless:*:*:namespace/*",
          "arn:aws:redshift-serverless:*:*:workgroup/*"
        ],
        "Sid": "RedshiftServerlessCreateDatabaseRole"
      },
      {
        "Action": [
          "redshift-data:DescribeStatement",
          "redshift-data:GetStatementResult",
          "redshift:DescribeDataSharesForConsumer",
          "redshift:DescribeDataShares"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "RedshiftData"
      },
      {
        "Action": [
          "redshift-serverless:UpdateNamespace",
          "redshift-serverless:UpdateWorkgroup",
          "redshift-serverless:UntagResource"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:redshift-serverless:*:*:namespace/*",
          "arn:aws:redshift-serverless:*:*:workgroup/*"
        ],
        "Sid": "RedshiftManagement"
      },
      {
        "Action": [
          "kms:Decrypt",
          "kms:Encrypt",
          "kms:GenerateDataKey"
        ],
        "Condition": {
          "Null": {
            "kms:EncryptionContext:aws:redshift-serverless:arn": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          },
          "StringLike": {
            "kms:ViaService": [
              "redshift-serverless.*.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "RedshiftKms"
      },
      {
        "Action": [
          "secretsmanager:GetRandomPassword"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "GetRandomPasswordForSecret"
      },
      {
        "Action": [
          "secretsmanager:DescribeSecret",
          "secretsmanager:CreateSecret",
          "secretsmanager:UpdateSecret",
          "secretsmanager:DeleteSecret",
          "secretsmanager:GetResourcePolicy",
          "secretsmanager:PutResourcePolicy",
          "secretsmanager:DeleteResourcePolicy",
          "secretsmanager:TagResource"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:secretsmanager:*:*:secret:amazon-bedrock-ide/*",
        "Sid": "BedrockSecret"
      },
      {
        "Action": [
          "secretsmanager:CreateSecret",
          "secretsmanager:RotateSecret",
          "secretsmanager:DescribeSecret",
          "secretsmanager:UpdateSecret",
          "secretsmanager:DeleteSecret"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": [
              "cloudformation.amazonaws.com"
            ],
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:secretsmanager:*:*:secret:redshift!*",
        "Sid": "RedshiftSecret"
      },
      {
        "Action": [
          "secretsmanager:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "Redshift",
              "aws:secretsmanager:*",
              "aws:redshift-serverless:*",
              "AmazonDataZone*",
              "datazone.rs.workgroup"
            ]
          },
          "Null": {
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:secretsmanager:*:*:secret:redshift!*",
        "Sid": "TagRedshiftSecret"
      },
      {
        "Action": [
          "sagemaker:CreateDomain",
          "sagemaker:AddTags"
        ],
        "Condition": {
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:sagemaker:*:*:domain/*",
        "Sid": "SageMakerDomainCreationAndTagging"
      },
      {
        "Action": [
          "sagemaker:UpdateDomain",
          "sagemaker:DeleteDomain"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:sagemaker:*:*:domain/*",
        "Sid": "SageMakerDomainUpdationAndDeletion"
      },
      {
        "Action": [
          "sagemaker:ListDomains",
          "sagemaker:DescribeDomain"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "SageMakerDomainManagement"
      },
      {
        "Action": [
          "sagemaker:DeleteApp"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:sagemaker:*:*:app/*/*/codeeditor/*",
          "arn:aws:sagemaker:*:*:app/*/*/CodeEditor/*",
          "arn:aws:sagemaker:*:*:app/*/*/jupyterlab/*",
          "arn:aws:sagemaker:*:*:app/*/*/JupyterLab/*"
        ],
        "Sid": "SageMakerAppDeletion"
      },
      {
        "Action": [
          "sagemaker:DeleteSpace"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:sagemaker:*:*:space/*",
        "Sid": "SageMakerSpaceDeletion"
      },
      {
        "Action": [
          "sagemaker:DeleteUserProfile"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:sagemaker:*:*:user-profile/*",
        "Sid": "SageMakerUserProfileDeletion"
      },
      {
        "Action": [
          "emr-serverless:CreateApplication",
          "emr-serverless:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "*"
        ],
        "Sid": "EmrSCreate"
      },
      {
        "Action": [
          "emr-serverless:UpdateApplication",
          "emr-serverless:DeleteApplication"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "*"
        ],
        "Sid": "EmrSManage"
      },
      {
        "Action": [
          "emr-serverless:GetApplication"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "*"
        ],
        "Sid": "EmrSGet"
      },
      {
        "Action": [
          "ec2:CreateNetworkInterface"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaLast": "ops.emr-serverless.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:network-interface/*"
        ],
        "Sid": "EmrSEc2Eni"
      },
      {
        "Action": [
          "ec2:CreateNetworkInterface"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaLast": "ops.emr-serverless.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:subnet/*",
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "EmrSEc2Subnet"
      },
      {
        "Action": [
          "sagemaker:CreateMlflowTrackingServer",
          "sagemaker:AddTags"
        ],
        "Condition": {
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:sagemaker:*:*:mlflow-tracking-server/*",
        "Sid": "SageMakerMlflowTrackingServerCreation"
      },
      {
        "Action": [
          "sagemaker:DescribeMlflowTrackingServer"
        ],
        "Effect": "Allow",
        "Resource": "arn:aws:sagemaker:*:*:mlflow-tracking-server/*",
        "Sid": "SageMakerMlflowTrackingServerDescribe"
      },
      {
        "Action": [
          "sagemaker:DeleteMlflowTrackingServer"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:sagemaker:*:*:mlflow-tracking-server/*",
        "Sid": "SageMakerMlflowTrackingServerDeletion"
      },
      {
        "Action": [
          "aoss:GetAccessPolicy",
          "aoss:CreateAccessPolicy",
          "aoss:DeleteAccessPolicy",
          "aoss:UpdateAccessPolicy"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          },
          "StringLikeIfExists": {
            "aoss:collection": "bedrock-ide-*",
            "aoss:index": "bedrock-ide-*"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ManageAossAccessPolicies"
      },
      {
        "Action": [
          "aoss:GetSecurityPolicy",
          "aoss:CreateSecurityPolicy",
          "aoss:DeleteSecurityPolicy",
          "aoss:UpdateSecurityPolicy"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          },
          "StringLikeIfExists": {
            "aoss:collection": "bedrock-ide-*"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ManageAossSecurityPolicies"
      },
      {
        "Action": [
          "aoss:BatchGetCollection"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "GetAossCollections"
      },
      {
        "Action": [
          "aoss:CreateCollection",
          "aoss:UpdateCollection",
          "aoss:DeleteCollection",
          "aoss:TagResource"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ManageAossCollections"
      },
      {
        "Action": [
          "s3:GetObject",
          "s3:GetObjectVersion"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:s3:::*/dzd_*/*/genAI/*",
        "Sid": "GetBedrockCfnResourceDefinitionS3"
      },
      {
        "Action": [
          "bedrock:GetAgent",
          "bedrock:GetKnowledgeBase",
          "bedrock:GetGuardrail",
          "bedrock:GetPrompt",
          "bedrock:GetFlow",
          "bedrock:GetFlowAlias",
          "bedrock:ListTagsForResource"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "GetBedrockResources"
      },
      {
        "Action": [
          "bedrock:CreateAgent",
          "bedrock:UpdateAgent",
          "bedrock:PrepareAgent",
          "bedrock:DeleteAgent",
          "bedrock:ListAgentAliases",
          "bedrock:GetAgentAlias",
          "bedrock:CreateAgentAlias",
          "bedrock:UpdateAgentAlias",
          "bedrock:DeleteAgentAlias",
          "bedrock:ListAgentActionGroups",
          "bedrock:GetAgentActionGroup",
          "bedrock:CreateAgentActionGroup",
          "bedrock:UpdateAgentActionGroup",
          "bedrock:DeleteAgentActionGroup",
          "bedrock:ListAgentKnowledgeBases",
          "bedrock:GetAgentKnowledgeBase",
          "bedrock:AssociateAgentKnowledgeBase",
          "bedrock:DisassociateAgentKnowledgeBase",
          "bedrock:UpdateAgentKnowledgeBase",
          "bedrock:CreateKnowledgeBase",
          "bedrock:UpdateKnowledgeBase",
          "bedrock:DeleteKnowledgeBase",
          "bedrock:ListDataSources",
          "bedrock:GetDataSource",
          "bedrock:CreateDataSource",
          "bedrock:UpdateDataSource",
          "bedrock:DeleteDataSource",
          "bedrock:ListIngestionJobs",
          "bedrock:GetIngestionJob",
          "bedrock:StartIngestionJob",
          "bedrock:StopIngestionJob",
          "bedrock:CreateGuardrail",
          "bedrock:UpdateGuardrail",
          "bedrock:DeleteGuardrail",
          "bedrock:CreateGuardrailVersion",
          "bedrock:CreatePrompt",
          "bedrock:UpdatePrompt",
          "bedrock:DeletePrompt",
          "bedrock:CreatePromptVersion",
          "bedrock:CreateFlow",
          "bedrock:UpdateFlow",
          "bedrock:PrepareFlow",
          "bedrock:DeleteFlow",
          "bedrock:ListFlowAliases",
          "bedrock:GetFlowAlias",
          "bedrock:CreateFlowAlias",
          "bedrock:UpdateFlowAlias",
          "bedrock:DeleteFlowAlias",
          "bedrock:ListFlowVersions",
          "bedrock:GetFlowVersion",
          "bedrock:CreateFlowVersion",
          "bedrock:DeleteFlowVersion",
          "bedrock:TagResource"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ManageBedrockResources"
      },
      {
        "Action": [
          "bedrock:TagResource"
        ],
        "Condition": {
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:bedrock:*:*:agent-alias/*/TSTALIASID",
          "arn:aws:bedrock:*:*:flow/*/alias/TSTALIASID"
        ],
        "Sid": "TagBedrockTestAliases"
      },
      {
        "Action": [
          "bedrock:ListEvaluationJobs"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ListBedrockJobs"
      },
      {
        "Action": [
          "bedrock:BatchDeleteEvaluationJob"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "ManageBedrockEvaluationJobs"
      },
      {
        "Action": [
          "lambda:CreateFunction",
          "lambda:InvokeFunction",
          "lambda:DeleteFunction",
          "lambda:UpdateFunctionCode",
          "lambda:GetFunctionConfiguration",
          "lambda:UpdateFunctionConfiguration",
          "lambda:ListVersionsByFunction",
          "lambda:PublishVersion",
          "lambda:GetPolicy",
          "lambda:AddPermission",
          "lambda:TagResource"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:lambda:*:*:function:amazon-bedrock-ide-*",
        "Sid": "BedrockLambda"
      },
      {
        "Action": [
          "lambda:GetFunction",
          "lambda:ListTags",
          "lambda:RemovePermission"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:lambda:*:*:function:amazon-bedrock-ide-*",
        "Sid": "ManageBedrockLambda"
      },
      {
        "Action": [
          "elasticmapreduce:CreateSecurityConfiguration",
          "elasticmapreduce:DeleteSecurityConfiguration"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "EMRSecurityConfigurationManagement"
      },
      {
        "Action": [
          "elasticmapreduce:AddJobFlowSteps",
          "elasticmapreduce:AddTags",
          "elasticmapreduce:DescribeJobFlows",
          "elasticmapreduce:ListInstanceFleets",
          "elasticmapreduce:ModifyInstanceFleet",
          "elasticmapreduce:RunJobFlow",
          "elasticmapreduce:SetTerminationProtection",
          "elasticmapreduce:TerminateJobFlows",
          "elasticmapreduce:DescribeCluster"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:elasticmapreduce:*:*:cluster/*",
        "Sid": "EMRClusterManagement"
      },
      {
        "Action": [
          "airflow:CreateEnvironment",
          "airflow:UpdateEnvironment",
          "airflow:DeleteEnvironment",
          "airflow:TagResource"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "AirflowEnvironmentActions"
      },
      {
        "Action": [
          "airflow:GetEnvironment"
        ],
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "AirflowGetEnvironment"
      },
      {
        "Action": [
          "s3:GetEncryptionConfiguration"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:s3:::*"
        ],
        "Sid": "AirflowS3BucketActions"
      },
      {
        "Action": [
          "ec2:CreateVpcEndpoint"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:vpc-endpoint/*",
          "arn:aws:ec2:*:*:vpc/*",
          "arn:aws:ec2:*:*:subnet/*",
          "arn:aws:ec2:*:*:security-group/*"
        ],
        "Sid": "AirflowVpcEndpointActions"
      },
      {
        "Action": [
          "ec2:CreateNetworkInterface"
        ],
        "Effect": "Allow",
        "Resource": [
          "arn:aws:ec2:*:*:subnet/*",
          "arn:aws:ec2:*:*:network-interface/*"
        ],
        "Sid": "AirflowNetworkInterfaceActions"
      },
      {
        "Action": [
          "kms:CreateGrant"
        ],
        "Condition": {
          "Null": {
            "kms:EncryptionContextKeys": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          },
          "StringLike": {
            "kms:ViaService": [
              "airflow.*.amazonaws.com"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "AirflowKmsCreateGrant"
      },
      {
        "Action": [
          "kms:DescribeKey"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "*",
        "Sid": "KmsDescribeKey"
      },
      {
        "Action": [
          "iam:GetRole",
          "iam:CreateRole",
          "iam:DetachRolePolicy",
          "iam:DeleteRolePolicy",
          "iam:AttachRolePolicy"
        ],
        "Condition": {
          "StringEquals": {
            "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole",
        "Sid": "QueryRoleManage"
      },
      {
        "Action": [
          "iam:CreateRole"
        ],
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole",
        "Sid": "QueryRoleCreate"
      },
      {
        "Action": [
          "iam:DetachRolePolicy",
          "iam:AttachRolePolicy"
        ],
        "Condition": {
          "ArnEquals": {
            "iam:PolicyARN": [
              "arn:aws:iam::aws:policy/service-role/SageMakerStudioQueryExecutionRolePolicy"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole",
        "Sid": "QueryRolePolicy"
      },
      {
        "Action": [
          "iam:TagRole"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "CreatedForUseWithSageMakerStudio",
              "SageMakerStudioQueryExecutionRole"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole",
        "Sid": "TagQueryRole"
      },
      {
        "Action": [
          "iam:ListAttachedRolePolicies"
        ],
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/SageMakerStudioQueryExecutionRole",
        "Sid": "ListQueryPolicy"
      },
      {
        "Action": [
          "ec2:DeleteSecurityGroup"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:ec2:*:*:security-group/*",
        "Sid": "SecurityGroupCleanUpForEMR"
      },
      {
        "Action": [
          "iam:ListAttachedRolePolicies",
          "iam:ListRolePolicies",
          "iam:ListInstanceProfilesForRole",
          "iam:DeleteRolePolicy",
          "iam:DeleteRole"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:role/datazone_emr_*",
        "Sid": "IAMRoleCleanUpForEMR"
      },
      {
        "Action": [
          "iam:RemoveRoleFromInstanceProfile",
          "iam:DeleteInstanceProfile"
        ],
        "Effect": "Allow",
        "Resource": "arn:aws:iam::*:instance-profile/datazone_emr_ec2_instance_profile_*",
        "Sid": "IAMInstanceProfileCleanUpForEMR"
      },
      {
        "Action": [
          "scheduler:ListTagsForResource",
          "scheduler:GetScheduleGroup"
        ],
        "Condition": {
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:scheduler:*:*:schedule-group/*",
        "Sid": "EventBridgeViewScheduleGroupActions"
      },
      {
        "Action": [
          "scheduler:DeleteScheduleGroup"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:scheduler:*:*:schedule-group/*",
        "Sid": "EventBridgeDeleteScheduleGroupActions"
      },
      {
        "Action": [
          "scheduler:CreateScheduleGroup"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": "AmazonDataZone*"
          },
          "Null": {
            "aws:RequestTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:scheduler:*:*:schedule-group/*",
        "Sid": "EventBridgeCreateScheduleGroupActions"
      },
      {
        "Action": [
          "scheduler:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": "AmazonDataZone*"
          },
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false",
            "aws:TagKeys": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:scheduler:*:*:schedule-group/*",
        "Sid": "EventBridgeTagScheduleGroupActions"
      },
      {
        "Action": [
          "scheduler:DeleteSchedule"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:CalledViaFirst": "cloudformation.amazonaws.com",
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:scheduler:*:*:schedule/SageMakerUnifiedStudio-*-*/*"
        ],
        "Sid": "EventBridgeScheduleDeleteAction"
      },
      {
        "Action": [
          "quicksight:CreateDataSource",
          "quicksight:CreateFolder",
          "quicksight:CreateFolderMembership",
          "quicksight:CreateVPCConnection",
          "quicksight:DeleteDataSource",
          "quicksight:DeleteFolder",
          "quicksight:DescribeDataSource",
          "quicksight:DescribeFolderPermissions",
          "quicksight:DescribeDataSourcePermissions",
          "quicksight:DeleteVPCConnection",
          "quicksight:ListFolderMembers",
          "quicksight:ListTagsForResource",
          "quicksight:UpdateDataSource",
          "quicksight:UpdateDataSourcePermissions",
          "quicksight:UpdateFolder",
          "quicksight:UpdateFolderPermissions",
          "quicksight:UpdateVPCConnection"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "*"
        ],
        "Sid": "ManageQuickSightFolder"
      },
      {
        "Action": [
          "quicksight:DescribeAccountSubscription",
          "quicksight:DescribeDataSet",
          "quicksight:DescribeDashboard",
          "quicksight:DescribeDashboardPermissions",
          "quicksight:DescribeFolder",
          "quicksight:DescribeGroup",
          "quicksight:DescribeGroupMembership",
          "quicksight:DescribeUser",
          "quicksight:DescribeVPCConnection",
          "quicksight:ListTagsForResource",
          "quicksight:UpdateDashboardPermissions"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:quicksight:*:*:*"
        ],
        "Sid": "ManageQuickSightOtherResourcesPermissions"
      },
      {
        "Action": [
          "quicksight:TagResource"
        ],
        "Condition": {
          "ForAllValues:StringLike": {
            "aws:TagKeys": [
              "AmazonDataZone*"
            ]
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:quicksight:*:*:*"
        ],
        "Sid": "ManageQuickSightTagCreationPermissions"
      },
      {
        "Action": [
          "iam:PassRole"
        ],
        "Condition": {
          "StringEquals": {
            "iam:PassedToService": "quicksight.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": [
          "arn:aws:iam::*:role/service-role/AmazonSageMakerQuickSightVPC",
          "arn:aws:iam::*:role/datazone_usr_role_*"
        ],
        "Sid": "PermissionsToIAMPassRoleForQuickSight"
      },
      {
        "Action": [
          "events:PutRule"
        ],
        "Condition": {
          "ForAllValues:StringEquals": {
            "events:source": [
              "aws.quicksight",
              "aws.codecommit"
            ]
          },
          "Null": {
            "events:detail-type": "false",
            "events:source": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}",
            "events:ManagedBy": "datazone.amazonaws.com",
            "events:detail-type": [
              "AWS Service Event via CloudTrail",
              "CodeCommit Repository State Change"
            ]
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:events:*:*:rule/Managed.SageMaker*",
        "Sid": "AllowPutRuleOnSpecificSourcesAndDetailTypes"
      },
      {
        "Action": [
          "events:DeleteRule",
          "events:DisableRule",
          "events:EnableRule",
          "events:PutTargets",
          "events:RemoveTargets"
        ],
        "Condition": {
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}",
            "events:ManagedBy": "datazone.amazonaws.com"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:events:*:*:rule/Managed.SageMaker*",
        "Sid": "AllowOtherOperationsOnRulesManagedBySMUS"
      },
      {
        "Action": [
          "secretsmanager:GetSecretValue"
        ],
        "Condition": {
          "Null": {
            "aws:ResourceTag/AmazonDataZoneProject": "false"
          },
          "StringEquals": {
            "aws:ResourceAccount": "${aws:PrincipalAccount}"
          }
        },
        "Effect": "Allow",
        "Resource": "arn:aws:secretsmanager:*:*:secret:*",
        "Sid": "GetRedshiftAdminSecretPermissions"
      }
    ],
    "Version": "2012-10-17"
  },
  "effective_actions": [
    {
      "access_level": "Write",
      "action": "cloudformation:CreateStack",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:CreateStack",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "cloudformation:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "cloudformation:DescribeStacks",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DescribeStacks",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "cloudformation:DescribeStackEvents",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DescribeStackEvents",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "cloudformation:UpdateStack",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:UpdateStack",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "cloudformation:DeleteStack",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DeleteStack",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "cloudformation:DescribeStacks",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DescribeStacks",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lakeformation:GetDataLakeSettings",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:GetDataLakeSettings",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "lakeformation:PutDataLakeSettings",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:PutDataLakeSettings",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "lakeformation:RevokePermissions",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:RevokePermissions",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "lakeformation:BatchRevokePermissions",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:BatchRevokePermissions",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "List",
      "action": "lakeformation:ListPermissions",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:ListPermissions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lakeformation:RegisterResource",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:RegisterResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lakeformation:DeregisterResource",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:DeregisterResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "lakeformation:GrantPermissions",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:GrantPermissions",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "lakeformation:BatchGrantPermissions",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:BatchGrantPermissions",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "List",
      "action": "lakeformation:ListResources",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:ListResources",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lakeformation:DescribeResource",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lakeformation:DescribeResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "s3:GetObject",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringNotEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "s3:GetObject",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "codecommit:CreateRepository",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:CreateRepository",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "codecommit:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "codecommit:DeleteRepository",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:DeleteRepository",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "codecommit:UpdateRepositoryEncryptionKey",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:UpdateRepositoryEncryptionKey",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "codecommit:PutRepositoryTriggers",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:PutRepositoryTriggers",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "codecommit:GetBranch",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "codecommit:GetBranch",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "codecommit:CreateCommit",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:CreateCommit",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "codecommit:GetRepository",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:GetRepository",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "codecommit:GetFile",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "codecommit:GetFile",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "codecommit:ListRepositories",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "codecommit:ListRepositories",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:Decrypt",
      "condition": {
        "Null": {
          "kms:EncryptionContext:aws:codecommit:id": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "codecommit.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:Decrypt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:ReEncryptTo",
      "condition": {
        "Null": {
          "kms:EncryptionContext:aws:codecommit:id": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "codecommit.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:ReEncryptTo",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:ReEncryptFrom",
      "condition": {
        "Null": {
          "kms:EncryptionContext:aws:codecommit:id": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "codecommit.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:ReEncryptFrom",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:GenerateDataKey",
      "condition": {
        "Null": {
          "kms:EncryptionContext:aws:codecommit:id": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "codecommit.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:GenerateDataKey",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "iam:GetRole",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "iam:CreateRole",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreateRole",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DetachRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DetachRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DeleteRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:AttachRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:AttachRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:PutRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PutRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DeleteRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:PutRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PutRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:CreateRole",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreateRole",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DetachRolePolicy",
      "condition": {
        "ArnEquals": {
          "iam:PolicyARN": [
            "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePolicy",
            "arn:aws:iam::aws:policy/SageMakerStudioProjectRoleMachineLearningPolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioEMRServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioEMRInstanceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/AmazonEMRServicePolicy_v2",
            "arn:aws:iam::aws:policy/AmazonSageMakerPartnerAppsFullAccess",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseServiceRolePolicy"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DetachRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:AttachRolePolicy",
      "condition": {
        "ArnEquals": {
          "iam:PolicyARN": [
            "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePolicy",
            "arn:aws:iam::aws:policy/SageMakerStudioProjectRoleMachineLearningPolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioEMRServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioEMRInstanceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/AmazonEMRServicePolicy_v2",
            "arn:aws:iam::aws:policy/AmazonSageMakerPartnerAppsFullAccess",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseServiceRolePolicy"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:AttachRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:AttachRolePolicy",
      "condition": {
        "ArnEquals": {
          "iam:PolicyARN": [
            "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockAgentServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockChatAgentUserRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockFlowServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockFunctionExecutionRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseCustomResourcePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockPromptUserRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockEvaluationJobServiceRolePolicy"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:AttachRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DetachRolePolicy",
      "condition": {
        "ArnEquals": {
          "iam:PolicyARN": [
            "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockAgentServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockChatAgentUserRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockFlowServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockFunctionExecutionRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseServiceRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockKnowledgeBaseCustomResourcePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockPromptUserRolePolicy",
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioBedrockEvaluationJobServiceRolePolicy"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DetachRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Tagging",
      "action": "iam:TagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "AmazonBedrockManaged",
            "RedshiftDb*",
            "EnableAmazonBedrockPermissions",
            "EnableAmazonBedrockIDEPermissions",
            "EnableGlueWorkloadsPermissions",
            "EnableSageMakerMLWorkloadsPermissions",
            "DomainBucketName",
            "KmsKeyId",
            "LogGroupName",
            "RoleName",
            "vpcArn",
            "VpcId",
            "CreatedForUseWithSageMakerStudio",
            "SageMakerStudioQueryExecutionRole"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:TagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "iam:UntagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "AmazonBedrockManaged",
            "RedshiftDb*",
            "EnableAmazonBedrockPermissions",
            "EnableAmazonBedrockIDEPermissions",
            "EnableGlueWorkloadsPermissions",
            "EnableSageMakerMLWorkloadsPermissions",
            "DomainBucketName",
            "KmsKeyId",
            "LogGroupName",
            "RoleName",
            "vpcArn",
            "VpcId",
            "CreatedForUseWithSageMakerStudio",
            "SageMakerStudioQueryExecutionRole"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:UntagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "iam:TagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "AmazonBedrockManaged",
            "DomainBucketName",
            "KmsKeyId",
            "AgentId",
            "AgentAliasId",
            "AppDefinitionPath",
            "DataSourcePath",
            "PromptId",
            "PromptVersion",
            "PromptDefinitionPath",
            "OpenSearchServerlessCollectionId"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:TagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "iam:UntagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "AmazonBedrockManaged",
            "DomainBucketName",
            "KmsKeyId",
            "AgentId",
            "AgentAliasId",
            "AppDefinitionPath",
            "DataSourcePath",
            "PromptId",
            "PromptVersion",
            "PromptDefinitionPath",
            "OpenSearchServerlessCollectionId"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:UntagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "iam:TagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "RedshiftDb*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:TagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "iam:TagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "DataZone*",
            "for-use-with-amazon-emr-managed-policies",
            "DomainBucketName",
            "KmsKeyId",
            "VpcId"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:TagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "iam:UntagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "DataZone*",
            "for-use-with-amazon-emr-managed-policies",
            "DomainBucketName",
            "KmsKeyId",
            "VpcId"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:UntagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "iam:UntagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": "EnableAmazonBedrockIDEPermissions"
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:UntagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "iam:DeleteRole",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteRole",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "List",
      "action": "iam:ListRolePolicies",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListRolePolicies",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "iam:GetRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetRolePolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "iam:ListAttachedRolePolicies",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListAttachedRolePolicies",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "iam:GetRole",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "iam:UpdateAssumeRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:UpdateAssumeRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:AttachRolePolicy",
      "condition": {
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:AttachRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DetachRolePolicy",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DetachRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DeletePolicy",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeletePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:CreatePolicy",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreatePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "List",
      "action": "iam:ListPolicies",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListPolicies",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "iam:GetPolicy",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "iam:GetPolicyVersion",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetPolicyVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "iam:CreatePolicyVersion",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreatePolicyVersion",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "List",
      "action": "iam:ListPolicyVersions",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListPolicyVersions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DeletePolicyVersion",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeletePolicyVersion",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "List",
      "action": "iam:ListPolicies",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListPolicies",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "glue:ListConnectionTypes",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:ListConnectionTypes",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "glue:DescribeConnectionType",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:DescribeConnectionType",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "iam:GetInstanceProfile",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetInstanceProfile",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "iam:CreateInstanceProfile",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreateInstanceProfile",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:AddRoleToInstanceProfile",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:AddRoleToInstanceProfile",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:RemoveRoleFromInstanceProfile",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:RemoveRoleFromInstanceProfile",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:DeleteInstanceProfile",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteInstanceProfile",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": [
            "cloudformation.amazonaws.com",
            "glue.amazonaws.com"
          ],
          "iam:PassedToService": [
            "glue.amazonaws.com",
            "lakeformation.amazonaws.com",
            "redshift-serverless.amazonaws.com",
            "redshift.amazonaws.com",
            "emr-serverless.amazonaws.com",
            "airflow.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "iam:PassedToService": [
            "sagemaker.amazonaws.com",
            "redshift-serverless.amazonaws.com",
            "bedrock.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "iam:PassedToService": [
            "glue.amazonaws.com",
            "lakeformation.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PassedToService": [
            "elasticmapreduce.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PassedToService": [
            "ec2.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PassedToService": "bedrock.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:PassedToService": "lambda.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:CreateServiceLinkedRole",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "iam:AWSServiceName": "observability.aoss.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreateServiceLinkedRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "glue:CreateDatabase",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:CreateDatabase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetDatabase",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetDatabase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:CreateDatabase",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:CreateDatabase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetDatabase",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetDatabase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:DeleteDatabase",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:DeleteDatabase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "glue:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetConnection",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:CreateConnection",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:CreateConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:DeleteConnection",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:DeleteConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:PassConnection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:PassConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetConnections",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetConnections",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetTags",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetTags",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "athena:CreateDataCatalog",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:CreateDataCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetConnection",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "athena:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "federated_athena*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:CreateConnection",
      "condition": {
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:CreateConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:DeleteConnection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:DeleteConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:UpdateConnection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:UpdateConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:DeleteConnection",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:DeleteConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:UpdateConnection",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:UpdateConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:Decrypt",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}",
          "kms:EncryptionContext:glue_catalog_id": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "glue.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:Decrypt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "serverlessrepo:GetCloudFormationTemplate",
      "condition": null,
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "serverlessrepo:GetCloudFormationTemplate",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "serverlessrepo:CreateCloudFormationTemplate",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "serverlessrepo:CreateCloudFormationTemplate",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "imagebuilder:GetComponent",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "lambda.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "imagebuilder:GetComponent",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "imagebuilder:GetContainerRecipe",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "lambda.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "imagebuilder:GetContainerRecipe",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "ecr:GetAuthorizationToken",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "lambda.amazonaws.com"
        }
      },
      "credentials_exposure": true,
      "data_access": false,
      "effective_action": "ecr:GetAuthorizationToken",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "ecr:BatchGetImage",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "lambda.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ecr:BatchGetImage",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "ecr:BatchCheckLayerAvailability",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "lambda.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ecr:BatchCheckLayerAvailability",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "ecr:GetDownloadUrlForLayer",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "lambda.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "ecr:GetDownloadUrlForLayer",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "cloudformation:CreateChangeSet",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:CreateChangeSet",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "cloudformation:DeleteChangeSet",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DeleteChangeSet",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:CreateFunction",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaLast": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:CreateFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:DeleteFunction",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaLast": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:DeleteFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lambda:GetFunction",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": [
            "athena.amazonaws.com",
            "cloudformation.amazonaws.com"
          ],
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "lambda:GetFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lambda:GetFunctionConfiguration",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:GetFunctionConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:UpdateFunctionConfiguration",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:UpdateFunctionConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "lambda:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "aws:cloudformation:*",
            "federated_athena*",
            "lambda:createdBy"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaLast": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "s3:GetObject",
      "condition": {
        "StringLike": {
          "aws:CalledViaLast": [
            "lambda.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "s3:GetObject",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "s3:ListBucket",
      "condition": {
        "Null": {
          "s3:prefix": "true"
        },
        "StringEquals": {
          "aws:CalledViaLast": [
            "glue.amazonaws.com"
          ],
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:ListBucket",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "cloudformation:CreateStack",
      "condition": {
        "Null": {
          "aws:ResourceTag/federated_athena_datacatalog": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:CreateStack",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "cloudformation:DeleteStack",
      "condition": {
        "Null": {
          "aws:ResourceTag/federated_athena_datacatalog": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DeleteStack",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "cloudformation:DescribeStacks",
      "condition": {
        "Null": {
          "aws:ResourceTag/federated_athena_datacatalog": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DescribeStacks",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "cloudformation:DescribeStackEvents",
      "condition": {
        "Null": {
          "aws:ResourceTag/federated_athena_datacatalog": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "cloudformation:DescribeStackEvents",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "athena:DeleteDataCatalog",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:DeleteDataCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "athena:GetDataCatalog",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:GetDataCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "athena:UpdateDataCatalog",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:UpdateDataCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "iam:PassedToService": [
            "lambda.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Read",
      "action": "iam:GetRole",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:CreateCatalog",
      "condition": {
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:CreateCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetCatalog",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetCatalogs",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetCatalogs",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:UpdateCatalog",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:UpdateCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "glue:DeleteCatalog",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:DeleteCatalog",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "glue:GetDatabase",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "glue:GetDatabase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:CreateNamespace",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:CreateNamespace",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:CreateWorkgroup",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:CreateWorkgroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:DeleteNamespace",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:DeleteNamespace",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:DeleteWorkgroup",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:DeleteWorkgroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "redshift-serverless:ListTagsForResource",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:ListTagsForResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift-serverless:GetNamespace",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:GetNamespace",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift-serverless:GetWorkgroup",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:GetWorkgroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift:AssociateDataShareConsumer",
      "condition": {
        "ForAnyValue:StringLike": {
          "aws:CalledVia": [
            "redshift-serverless.amazonaws.com",
            "glue.amazonaws.com"
          ]
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift:AssociateDataShareConsumer",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "redshift:AuthorizeDataShare",
      "condition": {
        "ForAnyValue:StringLike": {
          "aws:CalledVia": [
            "redshift-serverless.amazonaws.com",
            "glue.amazonaws.com"
          ]
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift:AuthorizeDataShare",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "s3:CreateBucket",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:CreateBucket",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "s3:DeleteBucket",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:DeleteBucket",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "s3:PutBucketPolicy",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:PutBucketPolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "s3:PutEncryptionConfiguration",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:PutEncryptionConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "s3:PutLifecycleConfiguration",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:PutLifecycleConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "s3:PutBucketVersioning",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:PutBucketVersioning",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "s3:PutBucketTagging",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:PutBucketTagging",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "redshift-serverless:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:CreateSecurityGroup",
      "condition": {
        "Null": {
          "aws:TagKeys": "true"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:CreateSecurityGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:AuthorizeSecurityGroupEgress",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:AuthorizeSecurityGroupEgress",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:AuthorizeSecurityGroupIngress",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:AuthorizeSecurityGroupIngress",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:DeleteSecurityGroup",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DeleteSecurityGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:RevokeSecurityGroupEgress",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:RevokeSecurityGroupEgress",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:RevokeSecurityGroupIngress",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:RevokeSecurityGroupIngress",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:RevokeSecurityGroupIngress",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:RevokeSecurityGroupIngress",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "ec2:CreateTags",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "for-use-with-amazon-emr-managed-policies",
            "aws:cloudformation:*"
          ]
        },
        "Null": {
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:CreateTags",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "ec2:DescribeVpcs",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DescribeVpcs",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "ec2:DescribeSecurityGroups",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DescribeSecurityGroups",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "ec2:DescribeNatGateways",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DescribeNatGateways",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "ec2:DescribeRouteTables",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DescribeRouteTables",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "ec2:DescribeSubnets",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DescribeSubnets",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "ec2:DescribeAccountAttributes",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DescribeAccountAttributes",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "ec2:DescribeAvailabilityZones",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DescribeAvailabilityZones",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "logs:DescribeLogGroups",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:DescribeLogGroups",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:CreateLogGroup",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "AmazonBedrockManaged"
          ]
        },
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:CreateLogGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "logs:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "AmazonBedrockManaged"
          ]
        },
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:PutRetentionPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:PutRetentionPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:DeleteLogGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:DeleteLogGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:DeleteRetentionPolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:DeleteRetentionPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "logs:GetDataProtectionPolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:GetDataProtectionPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:PutDataProtectionPolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:PutDataProtectionPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:DeleteDataProtectionPolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:DeleteDataProtectionPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:AssociateKmsKey",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:AssociateKmsKey",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "logs:DisassociateKmsKey",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:DisassociateKmsKey",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "logs:ListTagsForResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "logs:ListTagsForResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "athena:CreateWorkGroup",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:CreateWorkGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "athena:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "athena:DeleteWorkGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:DeleteWorkGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "athena:GetWorkGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "athena:GetWorkGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:CreateNamespace",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:CreateNamespace",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:CreateWorkgroup",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:CreateWorkgroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "redshift-serverless:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "redshift-serverless:ListTagsForResource",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:ListTagsForResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:CreateSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:ResourceTag/CreatedBy": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:CreateSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:DeleteSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:ResourceTag/CreatedBy": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DeleteSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:UpdateSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:ResourceTag/CreatedBy": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:UpdateSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "secretsmanager:DescribeSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DescribeSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "secretsmanager:DescribeSecret",
      "condition": {
        "StringEquals": {
          "aws:ResourceTag/for-use-with-all-datazone-projects": "true"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DescribeSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "secretsmanager:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*",
            "CreatedBy"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:ResourceTag/CreatedBy": "false",
          "aws:TagKeys": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:GenerateDataKey",
      "condition": {
        "Null": {
          "kms:EncryptionContext:SecretARN": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "secretsmanager.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:GenerateDataKey",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:Decrypt",
      "condition": {
        "Null": {
          "kms:EncryptionContext:SecretARN": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "secretsmanager.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:Decrypt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "iam:CreateServiceLinkedRole",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreateServiceLinkedRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "List",
      "action": "redshift-serverless:ListNamespaces",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:ListNamespaces",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "redshift-serverless:ListWorkgroups",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:ListWorkgroups",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift:GetResourcePolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift:GetResourcePolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-data:ExecuteStatement",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-data:ExecuteStatement",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift:GetResourcePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift:GetResourcePolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:GetCredentials",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:GetCredentials",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift-data:DescribeStatement",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-data:DescribeStatement",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift-data:GetStatementResult",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-data:GetStatementResult",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift:DescribeDataSharesForConsumer",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift:DescribeDataSharesForConsumer",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "redshift:DescribeDataShares",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift:DescribeDataShares",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:UpdateNamespace",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:UpdateNamespace",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "redshift-serverless:UpdateWorkgroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:UpdateWorkgroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "redshift-serverless:UntagResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "redshift-serverless:UntagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:Decrypt",
      "condition": {
        "Null": {
          "kms:EncryptionContext:aws:redshift-serverless:arn": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "redshift-serverless.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:Decrypt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:Encrypt",
      "condition": {
        "Null": {
          "kms:EncryptionContext:aws:redshift-serverless:arn": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "redshift-serverless.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:Encrypt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "kms:GenerateDataKey",
      "condition": {
        "Null": {
          "kms:EncryptionContext:aws:redshift-serverless:arn": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "redshift-serverless.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:GenerateDataKey",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "secretsmanager:GetRandomPassword",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:GetRandomPassword",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "secretsmanager:DescribeSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DescribeSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:CreateSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:CreateSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:UpdateSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:UpdateSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:DeleteSecret",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DeleteSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "secretsmanager:GetResourcePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:GetResourcePolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "secretsmanager:PutResourcePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:PutResourcePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "secretsmanager:DeleteResourcePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DeleteResourcePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Tagging",
      "action": "secretsmanager:TagResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:CreateSecret",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": [
            "cloudformation.amazonaws.com"
          ],
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:CreateSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:RotateSecret",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": [
            "cloudformation.amazonaws.com"
          ],
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:RotateSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "secretsmanager:DescribeSecret",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": [
            "cloudformation.amazonaws.com"
          ],
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DescribeSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:UpdateSecret",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": [
            "cloudformation.amazonaws.com"
          ],
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:UpdateSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "secretsmanager:DeleteSecret",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": [
            "cloudformation.amazonaws.com"
          ],
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:DeleteSecret",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "secretsmanager:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "Redshift",
            "aws:secretsmanager:*",
            "aws:redshift-serverless:*",
            "AmazonDataZone*",
            "datazone.rs.workgroup"
          ]
        },
        "Null": {
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:CreateDomain",
      "condition": {
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:CreateDomain",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "sagemaker:AddTags",
      "condition": {
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:AddTags",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:UpdateDomain",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:UpdateDomain",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:DeleteDomain",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:DeleteDomain",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "sagemaker:ListDomains",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:ListDomains",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "sagemaker:DescribeDomain",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:DescribeDomain",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:DeleteApp",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:DeleteApp",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:DeleteSpace",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:DeleteSpace",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:DeleteUserProfile",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:DeleteUserProfile",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "emr-serverless:CreateApplication",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "emr-serverless:CreateApplication",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "emr-serverless:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "emr-serverless:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "emr-serverless:UpdateApplication",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "emr-serverless:UpdateApplication",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "emr-serverless:DeleteApplication",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "emr-serverless:DeleteApplication",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "emr-serverless:GetApplication",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "emr-serverless:GetApplication",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:CreateNetworkInterface",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "ops.emr-serverless.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:CreateNetworkInterface",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:CreateNetworkInterface",
      "condition": {
        "StringEquals": {
          "aws:CalledViaLast": "ops.emr-serverless.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:CreateNetworkInterface",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:CreateMlflowTrackingServer",
      "condition": {
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:CreateMlflowTrackingServer",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "sagemaker:AddTags",
      "condition": {
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:AddTags",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "sagemaker:DescribeMlflowTrackingServer",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:DescribeMlflowTrackingServer",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "sagemaker:DeleteMlflowTrackingServer",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "sagemaker:DeleteMlflowTrackingServer",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "aoss:GetAccessPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*",
          "aoss:index": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:GetAccessPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:CreateAccessPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*",
          "aoss:index": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:CreateAccessPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:DeleteAccessPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*",
          "aoss:index": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:DeleteAccessPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:UpdateAccessPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*",
          "aoss:index": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:UpdateAccessPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "aoss:GetSecurityPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:GetSecurityPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:CreateSecurityPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:CreateSecurityPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:DeleteSecurityPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:DeleteSecurityPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:UpdateSecurityPolicy",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        },
        "StringLikeIfExists": {
          "aoss:collection": "bedrock-ide-*"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:UpdateSecurityPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "aoss:BatchGetCollection",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:BatchGetCollection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:CreateCollection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:CreateCollection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:UpdateCollection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:UpdateCollection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:DeleteCollection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:DeleteCollection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "aoss:TagResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "aoss:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "s3:GetObject",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "s3:GetObject",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "s3:GetObjectVersion",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "s3:GetObjectVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetAgent",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetAgent",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetKnowledgeBase",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetGuardrail",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetGuardrail",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetPrompt",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetPrompt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetFlow",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetFlow",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetFlowAlias",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetFlowAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:ListTagsForResource",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListTagsForResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateAgent",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateAgent",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateAgent",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateAgent",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:PrepareAgent",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:PrepareAgent",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteAgent",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteAgent",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListAgentAliases",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListAgentAliases",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetAgentAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetAgentAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateAgentAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateAgentAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateAgentAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateAgentAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteAgentAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteAgentAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListAgentActionGroups",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListAgentActionGroups",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetAgentActionGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetAgentActionGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateAgentActionGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateAgentActionGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateAgentActionGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateAgentActionGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteAgentActionGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteAgentActionGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListAgentKnowledgeBases",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListAgentKnowledgeBases",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetAgentKnowledgeBase",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetAgentKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:AssociateAgentKnowledgeBase",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:AssociateAgentKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DisassociateAgentKnowledgeBase",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DisassociateAgentKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateAgentKnowledgeBase",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateAgentKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateKnowledgeBase",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateKnowledgeBase",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteKnowledgeBase",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteKnowledgeBase",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListDataSources",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListDataSources",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListIngestionJobs",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListIngestionJobs",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetIngestionJob",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetIngestionJob",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:StartIngestionJob",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:StartIngestionJob",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:StopIngestionJob",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:StopIngestionJob",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateGuardrail",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateGuardrail",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateGuardrail",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateGuardrail",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteGuardrail",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteGuardrail",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateGuardrailVersion",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateGuardrailVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreatePrompt",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreatePrompt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdatePrompt",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdatePrompt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeletePrompt",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeletePrompt",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreatePromptVersion",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreatePromptVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateFlow",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateFlow",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateFlow",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateFlow",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:PrepareFlow",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:PrepareFlow",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteFlow",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteFlow",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListFlowAliases",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListFlowAliases",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetFlowAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetFlowAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateFlowAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateFlowAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:UpdateFlowAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:UpdateFlowAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteFlowAlias",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteFlowAlias",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListFlowVersions",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListFlowVersions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "bedrock:GetFlowVersion",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:GetFlowVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:CreateFlowVersion",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:CreateFlowVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:DeleteFlowVersion",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:DeleteFlowVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "bedrock:TagResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "bedrock:TagResource",
      "condition": {
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "bedrock:ListEvaluationJobs",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:ListEvaluationJobs",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "bedrock:BatchDeleteEvaluationJob",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "bedrock:BatchDeleteEvaluationJob",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:CreateFunction",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:CreateFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:InvokeFunction",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:InvokeFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:DeleteFunction",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:DeleteFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:UpdateFunctionCode",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:UpdateFunctionCode",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lambda:GetFunctionConfiguration",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:GetFunctionConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:UpdateFunctionConfiguration",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:UpdateFunctionConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "lambda:ListVersionsByFunction",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:ListVersionsByFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "lambda:PublishVersion",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:PublishVersion",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lambda:GetPolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:GetPolicy",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "lambda:AddPermission",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:AddPermission",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Tagging",
      "action": "lambda:TagResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lambda:GetFunction",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "lambda:GetFunction",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "lambda:ListTags",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:ListTags",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "lambda:RemovePermission",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "lambda:RemovePermission",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "elasticmapreduce:CreateSecurityConfiguration",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:CreateSecurityConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "elasticmapreduce:DeleteSecurityConfiguration",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:DeleteSecurityConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "elasticmapreduce:AddJobFlowSteps",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:AddJobFlowSteps",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "elasticmapreduce:AddTags",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:AddTags",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "elasticmapreduce:DescribeJobFlows",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:DescribeJobFlows",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "elasticmapreduce:ListInstanceFleets",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:ListInstanceFleets",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "elasticmapreduce:ModifyInstanceFleet",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:ModifyInstanceFleet",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "elasticmapreduce:RunJobFlow",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:RunJobFlow",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "elasticmapreduce:SetTerminationProtection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:SetTerminationProtection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "elasticmapreduce:TerminateJobFlows",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:TerminateJobFlows",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "elasticmapreduce:DescribeCluster",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "elasticmapreduce:DescribeCluster",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "airflow:CreateEnvironment",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "airflow:CreateEnvironment",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "airflow:UpdateEnvironment",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "airflow:UpdateEnvironment",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "airflow:DeleteEnvironment",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "airflow:DeleteEnvironment",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "airflow:TagResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "airflow:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "airflow:GetEnvironment",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "airflow:GetEnvironment",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "s3:GetEncryptionConfiguration",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "s3:GetEncryptionConfiguration",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:CreateVpcEndpoint",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:CreateVpcEndpoint",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:CreateNetworkInterface",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:CreateNetworkInterface",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "kms:CreateGrant",
      "condition": {
        "Null": {
          "kms:EncryptionContextKeys": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        },
        "StringLike": {
          "kms:ViaService": [
            "airflow.*.amazonaws.com"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": true,
      "effective_action": "kms:CreateGrant",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Read",
      "action": "kms:DescribeKey",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "kms:DescribeKey",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "iam:GetRole",
      "condition": {
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:GetRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "iam:CreateRole",
      "condition": {
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreateRole",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DetachRolePolicy",
      "condition": {
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DetachRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DeleteRolePolicy",
      "condition": {
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:AttachRolePolicy",
      "condition": {
        "StringEquals": {
          "iam:PermissionsBoundary": "arn:aws:iam::aws:policy/SageMakerStudioProjectUserRolePermissionsBoundary"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:AttachRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:CreateRole",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:CreateRole",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DetachRolePolicy",
      "condition": {
        "ArnEquals": {
          "iam:PolicyARN": [
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioQueryExecutionRolePolicy"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DetachRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Permissions management",
      "action": "iam:AttachRolePolicy",
      "condition": {
        "ArnEquals": {
          "iam:PolicyARN": [
            "arn:aws:iam::aws:policy/service-role/SageMakerStudioQueryExecutionRolePolicy"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:AttachRolePolicy",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Tagging",
      "action": "iam:TagRole",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "CreatedForUseWithSageMakerStudio",
            "SageMakerStudioQueryExecutionRole"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:TagRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "iam:ListAttachedRolePolicies",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListAttachedRolePolicies",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "ec2:DeleteSecurityGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "ec2:DeleteSecurityGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "iam:ListAttachedRolePolicies",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListAttachedRolePolicies",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "iam:ListRolePolicies",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListRolePolicies",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "List",
      "action": "iam:ListInstanceProfilesForRole",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:ListInstanceProfilesForRole",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "iam:DeleteRolePolicy",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteRolePolicy",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:DeleteRole",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteRole",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:RemoveRoleFromInstanceProfile",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:RemoveRoleFromInstanceProfile",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "iam:DeleteInstanceProfile",
      "condition": null,
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:DeleteInstanceProfile",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Read",
      "action": "scheduler:ListTagsForResource",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "scheduler:ListTagsForResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "scheduler:GetScheduleGroup",
      "condition": {
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "scheduler:GetScheduleGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "scheduler:DeleteScheduleGroup",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "scheduler:DeleteScheduleGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "scheduler:CreateScheduleGroup",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": "AmazonDataZone*"
        },
        "Null": {
          "aws:RequestTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "scheduler:CreateScheduleGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Tagging",
      "action": "scheduler:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": "AmazonDataZone*"
        },
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false",
          "aws:TagKeys": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "scheduler:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "scheduler:DeleteSchedule",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:CalledViaFirst": "cloudformation.amazonaws.com",
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "scheduler:DeleteSchedule",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:CreateDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:CreateDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:CreateFolder",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:CreateFolder",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:CreateFolderMembership",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:CreateFolderMembership",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:CreateVPCConnection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:CreateVPCConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:DeleteDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DeleteDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:DeleteFolder",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DeleteFolder",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeFolderPermissions",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeFolderPermissions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "quicksight:DescribeDataSourcePermissions",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeDataSourcePermissions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:DeleteVPCConnection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DeleteVPCConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:ListFolderMembers",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:ListFolderMembers",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:ListTagsForResource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:ListTagsForResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:UpdateDataSource",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:UpdateDataSource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "quicksight:UpdateDataSourcePermissions",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:UpdateDataSourcePermissions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:UpdateFolder",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:UpdateFolder",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "quicksight:UpdateFolderPermissions",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:UpdateFolderPermissions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "quicksight:UpdateVPCConnection",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:UpdateVPCConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeAccountSubscription",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeAccountSubscription",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeDataSet",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeDataSet",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeDashboard",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeDashboard",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeDashboardPermissions",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeDashboardPermissions",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeFolder",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeFolder",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeGroup",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeGroup",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeGroupMembership",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeGroupMembership",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeUser",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeUser",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:DescribeVPCConnection",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:DescribeVPCConnection",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "quicksight:ListTagsForResource",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:ListTagsForResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Permissions management",
      "action": "quicksight:UpdateDashboardPermissions",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:UpdateDashboardPermissions",
      "privesc": false,
      "resource_exposure": true
    },
    {
      "access_level": "Tagging",
      "action": "quicksight:TagResource",
      "condition": {
        "ForAllValues:StringLike": {
          "aws:TagKeys": [
            "AmazonDataZone*"
          ]
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "quicksight:TagResource",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "iam:PassRole",
      "condition": {
        "StringEquals": {
          "iam:PassedToService": "quicksight.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "iam:PassRole",
      "privesc": true,
      "resource_exposure": true
    },
    {
      "access_level": "Write",
      "action": "events:PutRule",
      "condition": {
        "ForAllValues:StringEquals": {
          "events:source": [
            "aws.quicksight",
            "aws.codecommit"
          ]
        },
        "Null": {
          "events:detail-type": "false",
          "events:source": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}",
          "events:ManagedBy": "datazone.amazonaws.com",
          "events:detail-type": [
            "AWS Service Event via CloudTrail",
            "CodeCommit Repository State Change"
          ]
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "events:PutRule",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "events:DeleteRule",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}",
          "events:ManagedBy": "datazone.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "events:DeleteRule",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "events:DisableRule",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}",
          "events:ManagedBy": "datazone.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "events:DisableRule",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "events:EnableRule",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}",
          "events:ManagedBy": "datazone.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "events:EnableRule",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "events:PutTargets",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}",
          "events:ManagedBy": "datazone.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "events:PutTargets",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Write",
      "action": "events:RemoveTargets",
      "condition": {
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}",
          "events:ManagedBy": "datazone.amazonaws.com"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "events:RemoveTargets",
      "privesc": false,
      "resource_exposure": false
    },
    {
      "access_level": "Read",
      "action": "secretsmanager:GetSecretValue",
      "condition": {
        "Null": {
          "aws:ResourceTag/AmazonDataZoneProject": "false"
        },
        "StringEquals": {
          "aws:ResourceAccount": "${aws:PrincipalAccount}"
        }
      },
      "credentials_exposure": false,
      "data_access": false,
      "effective_action": "secretsmanager:GetSecretValue",
      "privesc": false,
      "resource_exposure": false
    }
  ],
  "grantless": false,
  "malformed": false,
  "name": "SageMakerStudioProjectProvisioningRolePolicy",
  "privesc": true,
  "resource_exposure": true,
  "undocumented_actions": false,
  "unknown_actions": [],
  "updatedate": "2025-06-03T22:52:07+00:00",
  "version": "v15"
}